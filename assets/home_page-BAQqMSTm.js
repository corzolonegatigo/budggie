import*as t from"https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.module.js";import{FBXLoader as O}from"https://cdn.jsdelivr.net/npm/three@0.117.1/examples/jsm/loaders/FBXLoader.js";window.addEventListener("DOMContentLoaded",()=>{const y=document.getElementById("3js-env"),_=JSON.parse(window.localStorage.getItem("Userdata")).currentitem,l=new t.Scene;l.background=new t.Color(15650669);const a=new t.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.1,1e3);a.position.set(0,2,10),a.lookAt(0,0,0),l.add(new t.AmbientLight(16777215,.8));const x=new t.DirectionalLight(16777215,1);x.position.set(0,12,10),l.add(x);const d=new t.WebGLRenderer({antialias:!0});d.setSize(window.innerWidth/window.innerHeight),y.appendChild(d.domElement);const o=new t.TextureLoader,r=new t.Group;if(_!==""){const m=o.load("./models/hammer_txt/BaseColour.png"),p=o.load("./models/hammer_txt/AO.png"),i=o.load("./models/hammer_txt/Metallic.png"),f=o.load("./models/hammer_txt/Roughness.png"),w=o.load("./models/hammer_txt/Normals.png"),g=new t.MeshStandardMaterial({map:m,aoMap:p,metalnessMap:i,roughnessMap:f,normalMap:w}),P=o.load("./models/ps5_txt/BaseColour.png"),H=o.load("./models/ps5_txt/AO.png"),L=o.load("./models/ps5_txt/Metallic.png"),E=o.load("./models/ps5_txt/Roughness.png"),C=o.load("./models/ps5_txt/Normals.png"),W=new t.MeshStandardMaterial({map:P,aoMap:H,metalnessMap:L,roughnessMap:E,normalMap:C}),z=new t.MeshPhysicalMaterial({color:16777215,transmission:1,opacity:1,transparent:!0,roughness:.1,metalness:.1,ior:1.5,thickness:.5,envMapIntensity:1.5,side:t.DoubleSide}),h=new O;let c,n,s;h.load("./models/box2.fbx",u=>{n=u,n.scale.set(.06,.06,.06),n.traverse(e=>{e.isMesh&&(e.geometry?.attributes?.uv&&(e.geometry.attributes.uv2=e.geometry.attributes.uv),e.material=z)}),n.position.set(0,-.5,0),r.add(n)}),h.load("./models/ps5.fbx",u=>{c=u,c.scale.set(1.2,1.2,1.2),c.traverse(e=>{e.isMesh&&(e.geometry?.attributes?.uv&&(e.geometry.attributes.uv2=e.geometry.attributes.uv),e.material=W)}),c.position.set(0,0,0),n.add(c)}),h.load("./models/hammer_centered.fbx",u=>{s=u,s.scale.set(.05,.05,.05),s.traverse(e=>{e.isMesh&&(e.material=g)}),s.visible=!1,s.rotation.x=-.2,s.position.set(0,-2,2),r.add(s)});let M=!1;setInterval(()=>{s&&n&&(M=!M,s.visible=M,n.visible=!M)},3e3)}r.scale.set(1,1,1),l.add(r);function v(){const i=new t.Vector3;a.getWorldDirection(i);const f=new t.Vector3;f.crossVectors(i,a.up).normalize();const w=a.up.clone().normalize(),g=a.position.clone().add(i.multiplyScalar(10));window.innerWidth<=768?r.position.copy(g.add(w.multiplyScalar(-4/2))):r.position.copy(g.add(f.multiplyScalar(-8)).add(w.multiplyScalar(-4)).add(i.clone().multiplyScalar(0)))}function S(){r.rotation.y+=.005,v(),d.render(l,a)}d.setAnimationLoop(S);function b(){const m=window.innerWidth,p=window.innerHeight;a.aspect=m/p,a.updateProjectionMatrix(),d.setSize(m,p),v()}window.addEventListener("resize",b),b()});
